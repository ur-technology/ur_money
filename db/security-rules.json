{
    "rules": {
        "phoneAuthenticationQueue": {
            // Should allow read to everybody because a this point nobody is autheticated yet
            ".read": true,
            // Should allow read to everybody because a this point nobody is autheticated yet
            ".write": true,
            "tasks": {
                ".indexOn": "_state"
            }
        },
        "phoneLookupQueue": {
            "tasks": {
                ".indexOn": "_state",
                "$task": {
                    //allows to write and update only if the authenticated user writes its own data
                    ".write": "newData.child('userId').val()===auth.uid || data.child('userId').val()===auth.uid",
                    //allows read only if the authenticated user reads its own data
                    ".read": "data.child('userId').val()===auth.uid"
                }
            }
        },
        "chatMessageCopyingQueue": {
            "tasks": {
                ".indexOn": "_state",
                "$task": {
                    //allows to write and update only if the authenticated user writes its own data
                    ".write": "newData.child('userId').val()===auth.uid || data.child('userId').val()===auth.uid",
                    //allows read only if the authenticated user reads its own data
                    ".read": "data.child('userId').val()===auth.uid"
                }
            }
        },
        "chatSummaryCopyingQueue": {
            "tasks": {
                ".indexOn": "_state",
                "$task": {
                    //allows to write and update only if the authenticated user writes its own data
                    ".write": "newData.child('userId').val()===auth.uid || data.child('userId').val()===auth.uid",
                    //allows read only if the authenticated user reads its own data
                    ".read": "data.child('userId').val()===auth.uid"
                }
            }
        },
        "invitationQueue": {
            "tasks": {
                ".indexOn": "_state",
                "$task": {
                    //allows to write and update only if the authenticated user writes its own data
                    ".write": "newData.child('sponsorUserId').val()===auth.uid || data.child('sponsorUserId').val()===auth.uid",
                    //allows read only if the authenticated user reads its own data
                    ".read": "data.child('userId').val()===auth.uid"
                }
            }
        },
        "users": {
            ".indexOn": ["phone", "notificationProcessed"],
            //alow read and write to authenticated users only and only the user data
            "$uid": {
                ".read": "$uid===auth.uid",
                ".write": "$uid===auth.uid"
            }
        }
    }
}
